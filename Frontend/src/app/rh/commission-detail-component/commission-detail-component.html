<div class="commission-detail-container">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>Chargement des d√©tails...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-error">
    <span class="alert-icon">‚ö†Ô∏è</span>
    <p>{{ errorMessage }}</p>
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="alert alert-success">
    <span class="alert-icon">‚úÖ</span>
    <p>{{ successMessage }}</p>
  </div>

  <!-- Content -->
  <div *ngIf="!isLoading && commission" class="content">
    <!-- Header -->
    <header class="page-header">
      <div class="header-content">
        <div>
          <h1 class="page-title">{{ commission.name }}</h1>
          <p class="page-subtitle">Commission cr√©√©e le {{ formatDate(commission.createdAt) }}</p>
        </div>
        <div class="header-actions">
          <span class="status-badge" [ngClass]="'status-' + commission.status?.toLowerCase()">
            {{ getStatusLabel(commission.status) }}
          </span>
        </div>
      </div>
    </header>

    <!-- Main Info Section -->
    <section class="info-section">
      <h2 class="section-title">Informations g√©n√©rales</h2>

      <div class="info-grid">
        <div class="info-item">
          <span class="info-label">Offre d'emploi associ√©e</span>
          <span class="info-value">{{ commission.jobOfferTitle || 'N/A' }}</span>
        </div>

        <div class="info-item">
          <span class="info-label">Cr√©√©e par</span>
          <span class="info-value">{{ commission.createdByName || 'N/A' }}</span>
        </div>

        <div class="info-item">
          <span class="info-label">Nombre de membres</span>
          <span class="info-value">{{ commission.memberCount || 0 }}</span>
        </div>

        <div class="info-item">
          <span class="info-label">Derni√®re mise √† jour</span>
          <span class="info-value">{{ formatDate(commission.updatedAt) }}</span>
        </div>
      </div>

      <div *ngIf="commission.description" class="description-box">
        <h3 class="description-title">Description</h3>
        <p class="description-text">{{ commission.description }}</p>
      </div>

      <!-- Edit Mode -->
      <div *ngIf="isEditMode" class="edit-form">
        <div class="form-group">
          <label for="editName" class="form-label">Nom de la commission</label>
          <input
            type="text"
            id="editName"
            class="form-input"
            [(ngModel)]="editData.name"
          />
        </div>

        <div class="form-group">
          <label for="editDescription" class="form-label">Description</label>
          <textarea
            id="editDescription"
            class="form-textarea"
            [(ngModel)]="editData.description"
            rows="4"
          ></textarea>
        </div>

        <div class="form-group">
          <label for="editStatus" class="form-label">Statut</label>
          <select
            id="editStatus"
            class="form-select"
            [(ngModel)]="editData.status"
          >
            <option value="ACTIVE">Active</option>
            <option value="CLOSED">Ferm√©e</option>
            <option value="ARCHIVED">Archiv√©e</option>
          </select>
        </div>

        <div class="edit-actions">
          <button class="btn-secondary" (click)="cancelEdit()">Annuler</button>
          <button class="btn-primary" (click)="saveEdit()">Enregistrer</button>
        </div>
      </div>

      <div *ngIf="!isEditMode" class="section-actions">
        <button class="btn-edit" (click)="enableEditMode()">
          ‚úèÔ∏è Modifier les informations
        </button>
      </div>
    </section>

    <!-- President Section -->
    <section *ngIf="commission.president" class="president-section">
      <h2 class="section-title">Pr√©sident de la commission</h2>
      <div class="president-card">
        <div class="president-info">
          <div class="president-avatar">üë§</div>
          <div>
            <h3 class="president-name">{{ commission.president.userName }}</h3>
            <p class="president-email">{{ commission.president.userEmail }}</p>
            <p *ngIf="commission.president.expertiseArea" class="president-expertise">
              Expertise: {{ commission.president.expertiseArea }}
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Members Section -->
    <section class="members-section">
      <div class="section-header">
        <h2 class="section-title">Membres de la commission</h2>
        <button class="btn-add" (click)="toggleAddMemberForm()">
          {{ showAddMemberForm ? '‚úï Annuler' : '+ Ajouter un membre' }}
        </button>
      </div>

      <!-- Add Member Form -->
      <div *ngIf="showAddMemberForm" class="add-member-form">
        <h3 class="form-title">Ajouter un nouveau membre</h3>

        <div class="form-group">
          <label for="userId" class="form-label required">Utilisateur</label>
          <select
            id="userId"
            class="form-select"
            [(ngModel)]="newMember.userId"
            [class.error]="memberFormErrors['userId']"
          >
            <option value="">S√©lectionnez un utilisateur</option>
            <option *ngFor="let user of availableUsers" [ngValue]="user.id">
              {{ user.firstName }} ({{ user.lastName }})
            </option>
          </select>
          <span *ngIf="memberFormErrors['userId']" class="error-message">
            {{ memberFormErrors['userId'] }}
          </span>
        </div>

        <div class="form-group">
          <label for="role" class="form-label required">R√¥le</label>
          <select
            id="role"
            class="form-select"
            [(ngModel)]="newMember.role"
            [class.error]="memberFormErrors['role']"
          >
            <option value="">S√©lectionnez un r√¥le</option>
            <option *ngFor="let option of roleOptions" [value]="option.value">
              {{ option.label }}
            </option>
          </select>
                <span *ngIf="memberFormErrors['role']" class="error-message">
          {{ memberFormErrors['role'] }}
        </span>
        </div>

        <div class="form-group">
          <label for="expertiseArea" class="form-label">Domaine d'expertise</label>
          <input
            type="text"
            id="expertiseArea"
            class="form-input"
            [(ngModel)]="newMember.expertiseArea"
            placeholder="Ex: R√©seaux, S√©curit√© informatique..."
          />
        </div>

        <div class="form-actions">
          <button
            class="btn-primary"
            (click)="addMemberToCommission()"
            [disabled]="isAddingMember"
          >
            <span *ngIf="!isAddingMember">Ajouter</span>
            <span *ngIf="isAddingMember" class="loading-text">
              <span class="spinner-small"></span>
              Ajout en cours...
            </span>
          </button>
        </div>
      </div>

      <!-- Members List -->
      <div class="members-list">
        <div *ngIf="!commission.members || commission.members.length === 0" class="empty-state">
          <p>Aucun membre dans cette commission pour le moment.</p>
        </div>

        <div *ngFor="let member of commission.members" class="member-card">
          <div class="member-avatar">üë§</div>
          <div class="member-info">
            <h3 class="member-name">{{ member.userName }}</h3>
            <p class="member-email">{{ member.userEmail }}</p>
            <div class="member-meta">
              <span class="member-role">{{ member.role }}</span>
              <span *ngIf="member.expertiseArea" class="member-expertise">
                {{ member.expertiseArea }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Back Button -->
    <div class="back-button-container">
      <button class="btn-back" (click)="goBack()">
        ‚Üê Retour √† la liste des commissions
      </button>
    </div>
  </div>
</div>
