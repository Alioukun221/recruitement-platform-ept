<div class="detail-container">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner"></div>
    <p>Chargement des détails...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="errorMessage && !isLoading" class="error-state">
    <p class="error-message">{{ errorMessage }}</p>
    <button class="btn-retry" (click)="loadJobOffer()">Réessayer</button>
    <button class="btn-back" (click)="goBack()">Retour</button>
  </div>

  <!-- Content -->
  <div *ngIf="!isLoading && !errorMessage && jobOffer" class="detail-content">
    <!-- Header Actions -->
    <div class="top-actions">
      <button class="btn-back-header" (click)="goBack()">
        ← Retour aux offres
      </button>
    </div>

    <!-- Main Header -->
    <header class="offer-header">
      <div class="header-main">
        <h1 class="offer-title">{{ jobOffer.jobTitle }}</h1>
        <div class="header-meta">
          <span class="meta-item">
            <span class="icon"></span>
            {{ getJobTypeLabel(jobOffer.jobType) }}
          </span>
          <span class="meta-separator">•</span>
          <span class="meta-item">
            <span class="icon"></span>
            {{ getContractTypeLabel(jobOffer.typeContrat) }}
          </span>
          <span class="meta-separator">•</span>
          <span class="meta-item">
            <span class="icon"></span>
            Publié le {{ formatDate(jobOffer.datePublication) }}
          </span>
        </div>
      </div>
      <div class="header-actions">
        <button class="btn-action btn-primary" (click)="viewCandidates()">
          <span class="action-icon"></span>
          Voir les candidats
        </button>
        <button class="btn-action btn-secondary" (click)="downloadPDF()">
          <span class="action-icon"></span>
          Télécharger PDF
        </button>
        <button
          *ngIf="jobOffer.jobStatus === 'ARCHIVED'"
          class="btn-action btn-success"
          (click)="republishOffer()"
        >
          <span class="action-icon"></span>
          Republier
        </button>
        <button
          *ngIf="jobOffer.jobStatus !== 'ARCHIVED'"
          class="btn-action btn-warning"
          (click)="archiveOffer()"
        >
          <span class="action-icon"></span>
          Archiver
        </button>
      </div>
    </header>

    <!-- Layout Grid -->
    <div class="content-grid">
      <!-- Main Content -->
      <main class="main-content">
        <!-- Navigation Tabs -->
        <nav class="content-nav">
          <button class="nav-item active" (click)="scrollToSection('description')">
            Description
          </button>
          <button class="nav-item" (click)="scrollToSection('profile')">
            Profil recherché
          </button>
          <button class="nav-item" (click)="scrollToSection('admin')">
            Informations admin
          </button>
        </nav>

        <!-- Description Section -->
        <section id="description" class="content-section">
          <h2 class="section-title">
            <span class="title-icon"></span>
            Description du poste
          </h2>
          <div class="section-content">
            <p class="description-text">{{ jobOffer.description }}</p>
          </div>
        </section>

        <!-- Profile Section -->
        <section id="profile" class="content-section">
          <h2 class="section-title">
            <span class="title-icon"></span>
            Profil recherché
          </h2>
          <div class="section-content">
            <div class="profile-item">
              <h3 class="profile-subtitle">Niveau d'étude</h3>
              <p class="profile-value">{{ jobOffer.niveauEtudeRequis }}</p>
            </div>
            <div class="profile-item">
              <h3 class="profile-subtitle">Expérience requise</h3>
              <p class="profile-value">{{ jobOffer.experienceMin }} an(s) minimum</p>
            </div>
            <div class="profile-item">
              <h3 class="profile-subtitle">Compétences techniques requises</h3>
              <div class="skills-container">
                <span
                  *ngFor="let skill of requiredSkills"
                  class="skill-badge"
                >
                  {{ skill }}
                </span>
              </div>
            </div>
          </div>
        </section>

        <!-- Admin Section -->
        <section id="admin" class="content-section">
          <h2 class="section-title">
            <span class="title-icon">⚙</span>
            Informations administratives
          </h2>
          <div class="section-content">
            <div class="admin-grid">
              <div class="admin-item">
                <span class="admin-label">Créé par</span>
                <span class="admin-value">{{ jobOffer.createdByName || 'Non spécifié' }}</span>
              </div>
              <div class="admin-item">
                <span class="admin-label">Dernière modification</span>
                <span class="admin-value">{{ formatDate(jobOffer.lastModifiedDate) }}</span>
              </div>
              <div class="admin-item">
                <span class="admin-label">Type de contrat</span>
                <span class="admin-value">{{ getContractTypeLabel(jobOffer.typeContrat) }}</span>
              </div>
              <div class="admin-item">
                <span class="admin-label">Type d'emploi</span>
                <span class="admin-value">{{ getJobTypeLabel(jobOffer.jobType) }}</span>
              </div>
            </div>
          </div>
        </section>
      </main>

      <!-- Sidebar -->
      <aside class="sidebar">
        <!-- Status Card -->
        <div class="sidebar-card">
          <h3 class="card-title">Statut de l'offre</h3>
          <div class="status-display">
            <span class="status-badge-large" [ngClass]="getStatusClass(jobOffer.jobStatus)">
              {{ getStatusLabel(jobOffer.jobStatus) }}
            </span>
          </div>
        </div>

        <!-- Date Card -->
        <div class="sidebar-card">
          <h3 class="card-title">Date limite</h3>
          <div class="date-display">
            <p class="date-large">{{ formatDate(jobOffer.dateLimite) }}</p>
            <div *ngIf="!isExpired(jobOffer.dateLimite)" class="days-remaining">
              <span *ngIf="isExpiringSoon(jobOffer.dateLimite)" class="warning-text">
                ⚠ {{ getDaysRemaining(jobOffer.dateLimite) }} jour(s) restant(s)
              </span>
              <span *ngIf="!isExpiringSoon(jobOffer.dateLimite)" class="normal-text">
                {{ getDaysRemaining(jobOffer.dateLimite) }} jour(s) restant(s)
              </span>
            </div>
            <div *ngIf="isExpired(jobOffer.dateLimite)" class="days-remaining">
              <span class="danger-text">
                 Date limite dépassée
              </span>
            </div>
          </div>
        </div>

        <!-- Statistics Card -->
        <div class="sidebar-card">
          <h3 class="card-title">Statistiques</h3>
          <div class="stats-list">
            <div class="stat-item">
              <span class="stat-icon"></span>
              <div class="stat-content">
                <span class="stat-value">{{ jobOffer.applicationCount || 0 }}</span>
                <span class="stat-label">Candidature(s)</span>
              </div>
            </div>
            <div class="stat-item">
              <span class="stat-icon"></span>
              <div class="stat-content">
                <span class="stat-value">-</span>
                <span class="stat-label">Vues</span>
              </div>
            </div>
            <div class="stat-item">
              <span class="stat-icon"></span>
              <div class="stat-content">
                <span class="stat-value">-</span>
                <span class="stat-label">Présélectionnés</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Quick Actions Card -->
        <div class="sidebar-card">
          <h3 class="card-title">Actions rapides</h3>
          <div class="quick-actions">
            <button class="quick-action-btn" (click)="viewCandidates()">
              <span class="qa-icon"></span>
              <span class="qa-text">Liste des candidats</span>
            </button>
            <button class="quick-action-btn">
              <span class="qa-icon"></span>
              <span class="qa-text">Commission</span>
            </button>
            <button class="quick-action-btn">
              <span class="qa-icon"></span>
              <span class="qa-text">Exporter CSV</span>
            </button>
            <button class="quick-action-btn" (click)="downloadPDF()">
              <span class="qa-icon"></span>
              <span class="qa-text">Télécharger PDF</span>
            </button>
          </div>
        </div>
      </aside>
    </div>
  </div>
</div>
