<div class="container">
  <!-- Header Section -->
  <header class="page-header">
    <div class="header-content">
      <div class="header-left">
        <h1 class="page-title">Offres d'emploi</h1>
        <p class="page-subtitle">{{ filteredJobOffers.length }} offre(s) • {{ getActiveOffersCount() }} active(s)</p>
      </div>
      <div class="header-right">
        <button class="btn-secondary" (click)="exportData()">
          <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          Exporter
        </button>
        <button class="btn-primary" (click)="createNewOffer()">
          <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="16"></line>
            <line x1="8" y1="12" x2="16" y2="12"></line>
          </svg>
          Nouvelle offre
        </button>
      </div>
    </div>
  </header>

  <!-- Toolbar Section -->
  <section class="toolbar">
    <div class="toolbar-left">
      <div class="search-wrapper">
        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input
          type="text"
          class="search-input"
          placeholder="Rechercher une offre..."
          [(ngModel)]="searchQuery"
          (input)="onSearchChange()"
        />
        <button *ngIf="searchQuery" class="clear-search" (click)="clearSearch()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <div class="filter-chips">
        <button
          class="filter-chip"
          [class.active]="selectedStatus === status.value"
          *ngFor="let status of statusOptions.slice(1)"
          (click)="toggleStatusFilter(status.value)"
        >
          <span class="chip-dot" [class]="status.value"></span>
          {{ status.label }}
        </button>
      </div>
    </div>

    <div class="toolbar-right">
      <select class="filter-select compact" [(ngModel)]="selectedJobType" (change)="onJobTypeFilterChange()">
        <option *ngFor="let option of jobTypeOptions" [value]="option.value">{{ option.label }}</option>
      </select>

      <select class="filter-select compact" [(ngModel)]="selectedContractType" (change)="onContractTypeFilterChange()">
        <option *ngFor="let option of contractTypeOptions" [value]="option.value">{{ option.label }}</option>
      </select>

      <button class="btn-icon-only" (click)="toggleView()" title="Changer de vue">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="7" height="7"></rect>
          <rect x="14" y="3" width="7" height="7"></rect>
          <rect x="3" y="14" width="7" height="7"></rect>
          <rect x="14" y="14" width="7" height="7"></rect>
        </svg>
      </button>

      <button *ngIf="hasActiveFilters()" class="btn-text" (click)="resetFilters()">
        Réinitialiser
      </button>
    </div>
  </section>

  <!-- Bulk Actions Bar (shown when items are selected) -->
  <div *ngIf="selectedOffers.length > 0" class="bulk-actions-bar">
    <div class="bulk-info">
      <input type="checkbox" [checked]="isAllSelected()" (change)="toggleSelectAll()" class="checkbox-main" />
      <span class="bulk-count">{{ selectedOffers.length }} sélectionnée(s)</span>
    </div>
    <div class="bulk-actions">
      <button class="btn-bulk" (click)="bulkChangeStatus()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
        Changer le statut
      </button>
      <button class="btn-bulk danger" (click)="bulkDelete()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
          <polyline points="3 6 5 6 21 6"></polyline>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          <line x1="10" y1="11" x2="10" y2="17"></line>
          <line x1="14" y1="11" x2="14" y2="17"></line>
        </svg>
        Supprimer
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner"></div>
    <p>Chargement des offres...</p>
  </div>

  <!-- Error State -->
  <!--<div *ngIf="errorMessage && !isLoading" class="error-state">-->
  <!--  <div class="error-icon">-->
  <!--    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">-->
  <!--      <circle cx="12" cy="12" r="10"></circle>-->
  <!--      <line x1="12" y1="8" x2="12" y2="12"></line>-->
  <!--      <line x1="12" y1="16" x2="12.01" y2="16"></line>-->
  <!--    </svg>-->
  <!--  </div>-->
  <!--  <p class="error-message">{{ errorMessage }}</p>-->
  <!--  <button class="btn-primary" (click)="loadJobOffers()">Réessayer</button>-->
  <!--</div>-->

  <!-- Empty State -->
<!--  <div *ngIf="!isLoading && !errorMessage && filteredJobOffers.length === 0" class="empty-state">-->
<!--    <div class="empty-illustration">-->
<!--      <div class="empty-icon">-->
<!--        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">-->
<!--          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>-->
<!--          <polyline points="14 2 14 8 20 8"></polyline>-->
<!--          <line x1="9" y1="15" x2="15" y2="15"></line>-->
<!--          <line x1="9" y1="11" x2="15" y2="11"></line>-->
<!--        </svg>-->
<!--      </div>-->
<!--    </div>-->
<!--    <h3 class="empty-title">Aucune offre d'emploi</h3>-->
<!--    <p class="empty-description" *ngIf="hasActiveFilters()">-->
<!--      Aucun résultat ne correspond à vos filtres. Essayez de modifier vos critères de recherche.-->
<!--    </p>-->
<!--    <p class="empty-description" *ngIf="!hasActiveFilters()">-->
<!--      Commencez par créer votre première offre d'emploi pour attirer les meilleurs talents.-->
<!--    </p>-->
<!--    <button class="btn-primary" (click)="createNewOffer()">-->
<!--      <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">-->
<!--        <circle cx="12" cy="12" r="10"></circle>-->
<!--        <line x1="12" y1="8" x2="12" y2="16"></line>-->
<!--        <line x1="8" y1="12" x2="16" y2="12"></line>-->
<!--      </svg>-->
<!--      Créer la première offre-->
<!--    </button>-->
<!--  </div>-->

  <!-- Data Table -->
  <div class="table-container">
    <table class="data-table">
      <thead>
      <tr>
        <th class="col-checkbox">
          <input
            type="checkbox"
            [checked]="isAllSelected()"
            [indeterminate]="isSomeSelected()"
            (change)="toggleSelectAll()"
            class="checkbox-main"
          />
        </th>
        <th class="col-title sortable" (click)="sortBy('jobTitle')">
          <div class="th-content">
            <span>Titre du poste</span>
            <span class="sort-icon" *ngIf="sortColumn === 'jobTitle'">
              {{ sortDirection === 'asc' ? '↑' : '↓' }}
            </span>
          </div>
        </th>
        <th class="col-type sortable" (click)="sortBy('jobType')">
          <div class="th-content">
            <span>Type</span>
            <span class="sort-icon" *ngIf="sortColumn === 'jobType'">
              {{ sortDirection === 'asc' ? '↑' : '↓' }}
            </span>
          </div>
        </th>
        <th class="col-contract sortable" (click)="sortBy('typeContrat')">
          <div class="th-content">
            <span>Contrat</span>
            <span class="sort-icon" *ngIf="sortColumn === 'typeContrat'">
              {{ sortDirection === 'asc' ? '↑' : '↓' }}
            </span>
          </div>
        </th>
        <th class="col-status sortable" (click)="sortBy('jobStatus')">
          <div class="th-content">
            <span>Statut</span>
            <span class="sort-icon" *ngIf="sortColumn === 'jobStatus'">
              {{ sortDirection === 'asc' ? '↑' : '↓' }}
            </span>
          </div>
        </th>
        <th class="col-date sortable" (click)="sortBy('datePublication')">
          <div class="th-content">
            <span>Publication</span>
            <span class="sort-icon" *ngIf="sortColumn === 'datePublication'">
              {{ sortDirection === 'asc' ? '↑' : '↓' }}
            </span>
          </div>
        </th>
        <th class="col-date sortable" (click)="sortBy('dateLimite')">
          <div class="th-content">
            <span>Date limite</span>
            <span class="sort-icon" *ngIf="sortColumn === 'dateLimite'">
              {{ sortDirection === 'asc' ? '↑' : '↓' }}
            </span>
          </div>
        </th>
        <th class="col-applications sortable" (click)="sortBy('applicationCount')">
          <div class="th-content">
            <span>Candidatures</span>
            <span class="sort-icon" *ngIf="sortColumn === 'applicationCount'">
              {{ sortDirection === 'asc' ? '↑' : '↓' }}
            </span>
          </div>
        </th>
        <th class="col-actions">Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr
        *ngFor="let offer of filteredJobOffers"
        class="table-row"
        [class.selected]="isSelected(offer.id)"
        [class.expiring-soon]="isExpiringSoon(offer.dateLimite)"
        [class.expired]="isExpired(offer.dateLimite)"
      >
        <td class="col-checkbox">
          <input
            type="checkbox"
            [checked]="isSelected(offer.id)"
            (change)="toggleSelect(offer.id)"
            class="checkbox-row"
          />
        </td>

        <td class="col-title">
          <div class="title-cell">
            <span class="title-text" (click)="viewOfferDetails(offer.id)">{{ offer.jobTitle }}</span>
            <div class="title-meta">
            <span class="meta-badge" *ngIf="isExpiringSoon(offer.dateLimite) && !isExpired(offer.dateLimite)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
              Expire bientôt
            </span>
              <span class="meta-badge expired" *ngIf="isExpired(offer.dateLimite)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="15" y1="9" x2="9" y2="15"></line>
                <line x1="9" y1="9" x2="15" y2="15"></line>
              </svg>
              Expirée
            </span>
            </div>
          </div>
        </td>

        <td class="col-type">
          <div class="type-badge">
            <svg class="type-icon" viewBox="0 0 24 24" fill="none" stroke="#fef3c7" stroke-width="1">
              <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
              <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
            </svg>
            {{ getJobTypeLabel(offer.jobType) }}
          </div>
        </td>

        <td class="col-contract">
          <div class="contract-badge">
            <svg class="contract-icon" viewBox="0 0 24 24" fill="none" stroke="#fef3c7" stroke-width="1">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
            {{ getContractTypeLabel(offer.typeContrat) }}
          </div>
        </td>

        <td class="col-status">
        <span class="status-badge" [ngClass]="getStatusClass(offer.jobStatus)">
          <span class="status-dot"></span>
          {{ getStatusLabel(offer.jobStatus) }}
        </span>
        </td>

        <td class="col-date">
          <div class="date-cell">
            <span class="date-value">{{ formatDate(offer.datePublication) }}</span>
            <span class="date-relative">{{ getRelativeDate(offer.datePublication) }}</span>
          </div>
        </td>

        <td class="col-date">
          <div class="date-cell" [class.warning]="isExpiringSoon(offer.dateLimite)" [class.danger]="isExpired(offer.dateLimite)">
            <span class="date-value">{{ formatDate(offer.dateLimite) }}</span>
            <span class="date-relative">{{ getRelativeDate(offer.dateLimite) }}</span>
          </div>
        </td>

        <td class="col-applications">
          <div class="applications-cell" (click)="viewCandidates(offer.id)">
            <span class="app-count">{{ offer.applicationCount || 0 }}</span>
            <span class="app-label">candidat(s)</span>
          </div>
        </td>

        <td class="col-actions">
          <div class="actions-cell">
            <button class="btn-action" (click)="viewOfferDetails(offer.id)" title="Voir les détails">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
            </button>
            <button class="btn-action" (click)="viewCandidates(offer.id)" title="Voir les candidats">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
            </button>
            <button class="btn-action" (click)="editOffer(offer.id)" title="Modifier">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
              </svg>
            </button>
            <button class="btn-action danger" (click)="deleteOffer(offer)" title="Supprimer">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
              </svg>
            </button>
          </div>
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination (optional) -->
  <div *ngIf="!isLoading && !errorMessage && filteredJobOffers.length > 0" class="pagination">
    <div class="pagination-info">
      Affichage de <strong>{{ filteredJobOffers.length }}</strong> sur <strong>{{ jobOffers.length }}</strong> offre(s)
    </div>
    <div class="pagination-controls">
      <!-- Add pagination controls if needed -->
    </div>
  </div>
</div>
